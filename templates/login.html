<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Login</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <script src="https://www.gstatic.com/firebasejs/11.7.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.7.3/firebase-analytics.js"></script>
    <script type="module">
      const firebaseConfig = {
        apiKey: "AIzaSyD3CPcsCumWEKYdpZ-AtZmmSd5zFgTB6DY",
        authDomain: "mycyberlab-385dc.firebaseapp.com",
        projectId: "mycyberlab-385dc",
        storageBucket: "mycyberlab-385dc.firebasestorage.app",
        messagingSenderId: "797601034997",
        appId: "1:797601034997:web:d1917febdd0106a649cbbc",
        measurementId: "G-7B3MDKFH64",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
  </head>
  <body>
    <h2>Login to MyCyberLab</h2>
    <button onclick="loginWithGoogle()">Login with Google</button>
    <script>
      function loginWithGoogle() {
        const provider = new firebase.auth.GoogleAuthProvider();
        firebase
          .auth()
          .signInWithPopup(provider)
          .then((result) => result.user.getIdToken())
          .then((token) => {
            fetch("/sessionLogin", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ idToken: token }),
            })
              .then((res) => (window.location.href = "/dashboard"))
              .catch((err) => alert("Login failed: " + err));
          });
      }
    </script>
  </body>
</html>
