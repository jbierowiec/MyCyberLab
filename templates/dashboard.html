<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyCyberLab Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        overflow-x: hidden;
      }
      .sidebar {
        position: fixed;
        top: 56px;
        bottom: 0;
        left: 0;
        width: 200px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding-top: 1rem;
        background-color: #212529;
        transition: transform 0.3s ease-in-out;
        z-index: 1040;
        transform: translateX(-100%);
      }
      .sidebar-visible {
        transform: translateX(0);
      }
      .hamburger {
        border: none;
        background: none;
        color: white;
        font-size: 1.5rem;
      }
      @media (min-width: 768px) {
        .sidebar {
          transform: translateX(0);
        }
        .hamburger {
          display: none;
        }
      }
      main {
        margin-left: 200px;
        padding-top: 4rem;
        transition: margin-left 0.3s ease-in-out;
      }
      @media (max-width: 767.98px) {
        main {
          margin-left: 0;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark bg-dark fixed-top">
      <div class="container-fluid">
        <button class="hamburger" onclick="toggleSidebar()">&#9776;</button>
        <a class="navbar-brand ms-2" href="{{ url_for('dashboard') }}">MyCyberLab</a>
        <span class="navbar-text text-white">Logged in as {{ user['name'] }}</span>
        <a class="btn btn-outline-light ms-auto" href="{{ url_for('logout') }}">Logout</a>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <nav id="sidebar" class="col-md-2 sidebar text-white">
          <div>
            <ul class="nav flex-column">
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('ip_info') }}" onclick="closeSidebarIfMobile()">IP Info</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('dns_tool') }}" onclick="closeSidebarIfMobile()">DNS Lookup</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('file_metadata') }}" onclick="closeSidebarIfMobile()">Metadata Viewer</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('basic_cipher') }}" onclick="closeSidebarIfMobile()">Ciphers</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('key_logger') }}" onclick="closeSidebarIfMobile()">Key Logger</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('xss_tester') }}" onclick="closeSidebarIfMobile()">XSS Demo</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('port_scan') }}" onclick="closeSidebarIfMobile()">Port Scanner</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('hash_tool') }}" onclick="closeSidebarIfMobile()">Hash Generator</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('password_strength') }}" onclick="closeSidebarIfMobile()">Password Strength</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('password_cracker') }}" onclick="closeSidebarIfMobile()">Password Cracker</a></li>
            </ul>
          </div>
          <div>
            <ul class="nav flex-column mb-3">
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('view_uploads') }}" onclick="closeSidebarIfMobile()">My Uploads</a></li>
              <li class="nav-item"><a class="nav-link text-white" href="{{ url_for('view_downloads') }}" onclick="closeSidebarIfMobile()">My Downloads</a></li>
            </ul>
          </div>
        </nav>

        <main class="col-md-10 ms-sm-auto px-md-4">
          {% if show_welcome %}
          <div class="d-flex justify-content-center align-items-center" style="min-height: 30vh;">
            <h2 class="text-center">Welcome, {{ user['name'] }}! Glad to have you here.</h2>
          </div>
          {% endif %}

          {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
              <div class="container">
                {% for category, message in messages %}
                  <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          {% endwith %}

          {% block content %}{% endblock %}
        </main>
      </div>
    </div>
    <script>
      function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('sidebar-visible');
      }
      function closeSidebarIfMobile() {
        if (window.innerWidth < 768) {
          const sidebar = document.getElementById('sidebar');
          sidebar.classList.remove('sidebar-visible');
        }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>